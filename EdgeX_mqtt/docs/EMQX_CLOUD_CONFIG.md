# EMQX云配置说明

## 概述

本文档解释了温度控制系统中的MQTT通信如何配置为使用EMQX云，替代本地MQTT代理。

## 主要更改

1. **移除本地MQTT代理**
   - 从`docker-compose.yml`中移除了本地MQTT代理服务
   - 系统现在直接使用EMQX云作为消息代理

2. **MQTT配置硬编码**
   - **更新(2025年6月1日)**: 为了避免配置文件加载问题，现在在每个规则文件中直接硬编码EMQX云连接信息
   - 移除了对`mqtt_source.yaml`配置文件的依赖
   - 创建了`create_mqtt_source.json`文件，直接在流定义中包含所有连接参数

3. **eKuiper规则配置**
   - 规则已更新为直接使用EMQX云连接
   - 使用硬编码的连接参数代替CONF_KEY引用

## 连接详情

EMQX云连接信息：

- 服务器：`ssl://zd89891c.ala.cn-hangzhou.emqxsl.cn:8883`
- 用户名：`xu666xin`
- 密码：`123456`
- 客户端ID：根据不同服务有不同配置

## 验证连接

1. 使用`scripts/verify_emqx_connection.sh`脚本验证EMQX云连接
2. 检查eKuiper规则状态，确保规则正常运行

## 注意事项

1. **安全性**：在生产环境中，应考虑更安全的凭据管理方式
2. **连接问题**：如果出现连接问题，请先检查网络和EMQX云服务状态
3. **SSL证书**：系统配置为跳过SSL验证，这在生产环境中可能需要调整
